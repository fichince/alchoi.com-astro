---
import type { GetImageResult } from 'astro';
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';

interface Props {
  //cover: string;
  //title: string;
  height?: string;
  book: CollectionEntry<'cmsQuoteshelf'>;
}

const { book } = Astro.props;
const height = Astro.props.height ?? 'var(--size-px-14)';

/*
function isRemote(cover : string) : boolean {
  return cover.startsWith('https:') || cover.startsWith('http:');
}

const format = 'webp';

let image : GetImageResult;
try {
  // fetches image from remote URL
  if (isRemote(cover)) {
    image = await getImage({
      src: cover,
      height: 320,
      width: 320,
      format
    });
  } else {
    // dynamic import of local image
    const images = import.meta.glob<{ default: ImageMetadata }>('../../images/quoteshelf/*');

    image = await getImage({
      src: images[`../../images/quoteshelf/${cover}`](),
      format
    });
  }
} catch (e) {
  console.log(`failed to load cover for ${title}`, e);
}
*/

---
<Image 
  src={book.data.cover as ImageMetadata} 
  alt={book.data.title} 
  style={{ '--height': height }} 
/>

<style lang="scss">
  @import "../../style/mixins.scss";

  img {
    max-height: var(--height);
    width: auto;

    @include sm-up {
      max-height: calc(var(--height) * 1.5);
    }
  }
</style>
